<div id="adventure-profile">
  <div id="adventure-content">
    <app-header></app-header>
    <div class="adventure-container">
      <div class="d-flex flex-column adventure-view-title-container">
        <div class="d-flex flex-row mt-3">
          <div class="d-flex flex-column info">
            <div class="form-check">
              <button type="button" (click)="showAllUsers()" class="btn menu-btn justify-end align-items-center" >
                <span>Korisnici</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="showNewUsersRequests()" class="btn menu-btn justify-end align-items-center" >
                <span>Zahtevi za registraciju</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="showDeleteRequests()" class="btn menu-btn justify-end align-items-center" >
                <span>Zahtevi za brisanje naloga</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="showAppeals()" class="btn menu-btn justify-end align-items-center" >
                <span>Žalbe</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="showFeedbacks()" class="btn menu-btn justify-end align-items-center" >
                <span>Komentari</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="showReports()" class="btn menu-btn justify-end align-items-center" >
                <span>Izveštaji vlasnika</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="companyRules()" class="btn menu-btn justify-end align-items-center" >
                <span>Pravila poslovanja</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="openProfileDialog()" class="btn menu-btn justify-end align-items-center" >
                <span>Izmeni profil</span>
              </button>
            </div>
            <div class="form-check">
              <button type="button" (click)="calculateCompanyProfits()" class="btn menu-btn justify-end align-items-center" >
                <span>Profit kompanije</span>
              </button>
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'users'">
            <div class="d-flex flex-row">
              <span class="adventure-section me-2">Korisnici</span>
              <a class="red-link mt-2" (click)="addAdmin()">Dodaj admina</a>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3 adventures-container" *ngFor="let user of allUsers | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">{{user.firstName}} {{user.lastName}} </h4>
                      <p class="card-text">Email: {{user.email}}</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" *ngIf="user.id != admin.id" class="btn add-action-button"
                    (click)="deleteUser(user.id)">Obriši</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'new users'">
            <div class="d-flex flex-row mt-2">
              <span class="adventure-section me-2">Novi korisnici</span>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3 adventures-container" *ngFor="let newUserRequest of newUserRequests | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">{{newUserRequest.firstName}} {{newUserRequest.lastName}} </h4>
                      <p class="card-text">Razlog za registraciju: {{newUserRequest.reasonForRegistration}}</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" class="btn add-action-button"
                    (click)="activateNewUser(newUserRequest.id)">Odobri</button>
                  </div>
                  <div class="d-flex me-3 mb-3 justify-content-end" >
                    <button type="button" class="btn add-action-button"
                    (click)="declineNewUser(newUserRequest.id)">Odbij</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'delete requests'">
            <div class="d-flex flex-row mt-2">
              <span class="adventure-section me-2">Zahtevi za brisanje naloga</span>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3 adventures-container" *ngFor="let request of unansweredDeleteRequests | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Korisnik: {{request.userInfo.firstName}} {{request.userInfo.lastName}} </h4>
                      <p class="card-text">Razlog: {{request.description}}</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" class="btn add-action-button"
                    (click)="answerOnDeleteRequest(request.id)">Odgovori</button>
                  </div>
                </div>
              </div> 
            </div>
            <div class="d-flex flex-row mt-3 adventures-container" *ngFor="let request of answeredDeleteRequests | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Korisnik: {{request.userInfo.firstName}} {{request.userInfo.lastName}} </h4>
                      <p class="card-text">Razlog: {{request.description}}</p>
                    </div>
                  </div>
                </div>
              </div> 
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'appeals'">
            <div class="d-flex flex-row mt-2">
              <span class="adventure-section me-2">Žalbe</span>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3" *ngFor="let appeal of unansweredAppeals | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Vlasnik: {{appeal.owner.firstName}} {{appeal.owner.lastName}} </h4>
                      <h4 class="card-title">Gost: {{appeal.guest.firstName}} {{appeal.guest.lastName}} </h4>
                      <p class="card-text">Komentar: {{appeal.review}}</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" class="btn add-action-button"
                    (click)="answerOnReport(appeal.ownerId, appeal.guestId, appeal.id)">Odgovori</button>
                  </div>
                </div>
              </div> 
            </div>
            <div class="d-flex flex-row mt-3 adventures-container" *ngFor="let appeal of answeredAppeals | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Vlasnik: {{appeal.owner.firstName}} {{appeal.owner.lastName}} </h4>
                      <h4 class="card-title">Gost: {{appeal.guest.firstName}} {{appeal.guest.lastName}} </h4>
                      <p class="card-text">Komentar: {{appeal.review}}</p>
                    </div>
                  </div>
                </div>
              </div> 
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'feedbacks'">
            <div class="d-flex flex-row mt-2">
              <span class="adventure-section me-2">Komentari</span>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3" *ngFor="let feedback of notApprovedFeedbacks | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">{{feedback.type}} {{feedback.name}} </h4>
                      <p class="card-text">Ocena: {{feedback.grade}}</p>
                      <p class="card-text">Komentar: {{feedback.review}}</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" class="btn add-action-button"
                    (click)="approveFeedback(feedback.id)">Odobri</button>
                  </div>
                  <div class="d-flex me-3 mb-3 justify-content-end" >
                    <button type="button" class="btn add-action-button"
                    (click)="deleteFeedback(feedback.id)">Izbriši</button>
                  </div>
                </div>
              </div> 
            </div>
            <div class="d-flex flex-row mt-3" *ngFor="let feedback of approvedFeedbacks | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">{{feedback.type}} {{feedback.name}} </h4>
                      <p class="card-text">Ocena: {{feedback.grade}}</p>
                      <p class="card-text">Komentar: {{feedback.review}}</p>
                    </div>
                  </div>
                </div>
              </div> 
            </div>
          </div>
          <div class="d-flex ms-5 flex-column adventures" *ngIf="content == 'reports'">
            <div class="d-flex flex-row mt-2">
              <span class="adventure-section me-2">Izveštaji</span>
              <div class="d-flex search justify-content-end">
                <input type="text" placeholder="Pretraži..." name="search" [(ngModel)]="filterTerm">
              </div>
            </div>
            <div class="d-flex flex-row mt-3" *ngFor="let report of notReviewedReports | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Vlasnik: {{report.ownerFullName}} </h4>
                      <h4 class="card-title">Gost: {{report.guestFullName}} </h4>
                      <p class="card-text">Komentar: {{report.comment}}</p>
                      <p class="card-text" *ngIf="report.penaltyProposal">Preporučen penal za gosta!</p>
                    </div>
                  </div>
                </div>
                <div class="d-flex flex-row-reverse">
                  <div class="d-flex me-3 mb-3 justify-content-end ">
                    <button type="button" class="btn add-action-button"
                    (click)="answerOnReport(report.ownerId, report.guestId, report.id)">Odgovori</button>
                  </div>
                </div>
              </div> 
            </div>
            <div class="d-flex flex-row mt-3" *ngFor="let report of reviewedReports | filter:filterTerm">
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex flex-row">
                    <div class="d-flex flex-column me-3">
                      <h4 class="card-title">Vlasnik: {{report.ownerFullName}} </h4>
                      <h4 class="card-title">Gost: {{report.guestFullName}} </h4>
                      <p class="card-text">Komentar: {{report.comment}}</p>
                      <p class="card-text" *ngIf="report.penaltyProposal">Preporučen penal za gosta!</p>
                    </div>
                  </div>
                </div>
              </div> 
            </div>
          </div>
      </div>
    </div>
  </div>
  <ngx-alerts></ngx-alerts>
  <app-footer></app-footer>
</div>
